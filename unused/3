# Define VS Code Extension IDs for Angular, Bootstrap, HTML, and Snippets
$extensions = @(
    "angular.ng-template",               # Angular Language Service
    "esbenp.prettier-vscode",            # Code formatter (Prettier)
    "dbaeumer.vscode-eslint",             # JavaScript linter (ESLint)
    "ms-vscode.vscode-typescript",        # TypeScript language support
    "formulahendry.auto-close-tag",  # Auto close tags
    "VisualStudioExptTeam.vscodeintellicode", # AI based autocompletion
    "usernamehw.errorlens",        # Show Errors
    "thekalinga.bootstrap4-vscode",
    "AnbuselvanRocky.bootstrap5-vscode",
    "vscode-bootstrap.bootstrap-4-snippets",  # Bootstrap 4 Snippets
    "Zignd.html-css-class-completion", # CSS class name autocompletion
     "michelemelluso.code-spell-checker"  # Spell Checker
)

$profileName = "new"  # New profile name

# Function to check if VS Code is installed
function Check-VSCodeInstalled {
    try {
        # Attempt to run "code --version". If it fails, VS Code is likely not installed.
        $null = code --version
        return $true
    }
    catch {
        return $false
    }
}

# Check if VS Code is installed
if (-not (Check-VSCodeInstalled)) {
    Write-Host "..."
    return
}

Write-Host "..."

# Install each extension
foreach ($extension in $extensions) {
    Write-Host "..." -NoNewline
    try {
        # Use the 'code --install-extension' command with the profile option
        code --profile "$profileName" --install-extension $extension | Out-Null
    }
    catch {
       Write-Host "Error" -NoNewline
    }
}
Write-Host "All"